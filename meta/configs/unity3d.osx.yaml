- defaults:
    link:
      create: true
      relink: true
      force: true
- link:
    ~/.Unity3D: apps/Unity3D

- brew:
  - imagemagick
  - librsvg
  - pcre
  - rbenv

- cask:
  - java8
  - android-sdk
  - fastlane

- shell++:
  - description: Pre-install latest version of Unity3D
    condition: 'true'
  - stderr: true
    command: |
      # See https://stackoverflow.com/questions/9132826/stop-developer-tools-access-needs-to-take-control-of-another-process-for-debugg
      sudo /usr/sbin/DevToolsSecurity --enable

      ~/.Unity3D/unity-init.sh

      ~/.Unity3D/unity-install.sh 2018.3.7f1

- shell++:
  - description: Install cocoapods for build iOS
    condition: 'true'
  - stderr: true
    command: |
      # Install Ruby for fastlane
      echo N | rbenv install 2.4.2

      # Install bundle package manager
      rbenv rehash
      rbenv shell 2.4.2
      gem install activesupport -v 4.2.6
      gem install bundle cocoapods
      rbenv rehash

- shell++:
  - description: Accept all licenses
    condition: 'true'
  - stderr: true
    command: |
      touch ~/.android/repositories.cfg

      # yes | sdkmanager --licenses
      # Can NOT use yes pipe that will cause deadlock
      sdkmanager --licenses

- shell++:
  - description: Pre-install Android SDKs
    condition: 'true'
  - stderr: true
    command: |
      wget -qO- https://dl.google.com/android/repository/android-ndk-r16b-darwin-x86_64.zip | tar xz - -C /usr/local/share/android-ndk/

      # Android SDK build tools
      echo y | sdkmanager "platform-tools" "build-tools;28.0.3" "tools" "extras;android;m2repository"

      echo y | sdkmanager "platforms;android-16" "sources;android-16"
      echo y | sdkmanager "platforms;android-27" "sources;android-27"
      echo y | sdkmanager "platforms;android-28" "sources;android-28"
