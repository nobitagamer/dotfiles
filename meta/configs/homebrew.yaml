- defaults:
    link:
      create: true
      relink: true
      force: true
- link:
    ~/.Brewfile: Brewfile

# Installed outside of dotbot because it's required by git.
# - shell++:
#   - description: Install Xcode command line tools
#     condition: 'true'
#   - stdout: true
#     stderr: true
#     command: |
#       # Install Xcode command line tools
#       xcode-select --install

- shell++:
  - description: Install Homebrew
    condition: '! hash brew 2>/dev/null'
  - stdout: true
    stderr: true
    command: |
      /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"

# - brewfile:
#     # This accepts the same options as `brew bundle` command:
#     file: ~/.Brewfile
#     no-upgrade: true

- tap:
  - homebrew/cask-versions
  - homebrew/cask
  # - pivotal/tap

- brew:
  - mas
  - git-extras
  - git-flow-avh
  # - gitversion
  - exa
  # - fish
  - tmux
  - tmate
  # - curl --with-openssl
  - wget
  - curl
  # Update 12 year old rsync on macOS Mojave
  - rsync
  - jq

# Support for dedupe.sh, see https://apple.stackexchange.com/questions/69223/how-to-replace-mac-os-x-utilities-with-gnu-core-utilities
# - brew:
#   - coreutils
#   - findutils
#   - gnu-tar
#   - gnu-sed
#   - gawk
#   - gnutls
#   - gnu-indent
#   - grep
#   - gnu-cp
#   - jdupes

- brew: [zsh, zsh-completions, zsh-syntax-highlighting]

- cask:
  - dotnet
  - gitkraken
  - iterm2
  # - kdiff3 # not available any more
  # - visual-studio # Will install with Unity
  - visual-studio-code
  - powershell

- shell++:
  - description: Install GitVersion 5.0.1
    condition: 'true'
  - stdout: true
    stderr: true
    command: |
      # 5.0.1 is latest stable version that support exit code.
      brew unlink gitversion & brew install https://raw.githubusercontent.com/Homebrew/homebrew-core/56b5ff6813815eec8f8bbbe92856c1ce827ececc/Formula/gitversion.rb
      brew link gitversion
      brew pin gitversion

      # Update the formulae and Homebrew itself
      brew update

      # Upgrade everything
      brew upgrade

- shell++:
  - description: Install Apps
    condition: 'true'
  - stdout: true
    stderr: true
    command: |
      # Install XCode
      mas install 497799835
      sudo xcodebuild -license accept

      # Install Slack
      mas install 803453959

      # Install OneDrive
      mas install 823766827

- shell++:
  - description: Run XCode First Lauch to accept license
    condition: '! xcodebuild -checkFirstLaunchStatus'
  - stdout: true
    stderr: true
    command: |
      sudo xcodebuild -runFirstLaunch
